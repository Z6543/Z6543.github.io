---           
layout: post
title: Change passwords regularly - a myth and a lie, don't be fooled, part 1 
date: 2019-10-08 13:49:47 UTC
updated: 2019-10-08 13:49:47 UTC
comments: false
categories: password security
---

TL;DR: different passwords have different protection requirements, and different attackers using various attacks can only be prevented through different prevention methods. Password security is not simple. For real advise, checking the second post (in progress).

Are you sick of password advices like "change your password regularly" or "if your password is password change it to pa$$w0rd"? This post is for you!

The news sites are full of password advises nowadays due to recent breaches. When I read/watch <a href="https://www.youtube.com/watch?v=qz5i171h_no" target="_blank">these advise (especially on CNN</a>), I am usually pissed off for a lot of reasons. Some advises are terrible (<a href="https://xato.net/passwords/the-worst-password-tips/" target="_blank">a good collection is here</a>), some are good but without solutions, and others are better, but they don't explain the reasons. Following is my analysis of the problem. It works for me. It might not work for you. Comments are welcome!

<h2>Password history</h2>Passwords have been used since <a href="http://en.wikipedia.org/wiki/Password#History_of_passwords" target="_blank">ancient times</a>.

<div class="separator" style=""><a href="https://z6543.github.io/_img/15f1ae857ca97193ffff8102ffffd524.jpg" src="https://z6543.github.io/_img/15f1ae857ca97193ffff8102ffffd524.jpg" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="" src="https://z6543.github.io/_img/15f1ae857ca97193ffff8102ffffd524.jpg" width="320"/></a></div>
Because it is simple. When I started using <a href="http://seriesandtv.com/wp-content/uploads/2013/06/the-internet.png" target="_blank">the Internet</a>, I believe I had three passwords. Windows login, webmail, and IRC. Now I have ~250 accounts/passwords to different things, like to my smartphone, to my cable company (this password can be used to change the channels on the TV), to my online secure cloud storage, to full disk encryption to start my computer, <strike>to my nude pictures</strike>, to my WiFi router, to my cloud server hosting provider, etc etc etc. My money is protected with passwords, my communication is protected with passwords/encryption, my work is protected with passwords. It is pretty damn important. But yet people tend to choose lame passwords. Pretty lame ones. Because they don't think it can be significant. But what is not essential today will be relevant tomorrow. The service you used to download music (iTunes) with the lame password will one day protect all your Apple devices, where attackers can download your backup files, <a href="http://www.wired.com/2012/08/apple-amazon-mat-honan-hacking/all/" target="_blank">erase all your devices</a>, etc. <a href="http://lukenotricks.blogspot.nl/2010/03/8-characters-long-and-include-at-least.html" target="_blank">The seven-character and one capital rule is not enough anymore.</a> This advice is like PDF is safe to open, Java is secure. Old, outdated, untrue.

Now, after this lengthy prologue, we will deep dive into the analysis of the problem, by checking what we want to protect, against whom (who is the attacker), and only after that, we can analyze the solutions. Travel with me, I promise it will be fun! ;)

<h2>What to protect?</h2><div>There are different services online, and various services need different ways to protect. You don't use the same lock on your <a href="https://www.youtube.com/watch?v=EJOIjQJAL30" target="_blank">Trabant</a> as you do on your <a href="https://www.youtube.com/watch?v=j82VKi8NNsM" target="_blank">BMW</a>.

</div><div><h3>Internet banking, online money</h3><div>For me, this is the most vital service to protect. Luckily, most of the internet banking services use two-factor authentication (2FA), but unfortunately, not all of them offer <a href="http://en.wikipedia.org/wiki/Transaction_verification" target="_blank">transaction authorization/verification</a> with complete transactions. 2FA is not effective against malware, it just complicates the attack. Transaction authorization/verification is better, but not perfect (see <a href="http://www.kaspersky.com/about/news/virus/2011/Teamwork_How_the_ZitMo_Trojan_Bypasses_Online_Banking_Security" target="_blank">Zitmo</a>). If the access is not protected with 2FA, better choose the best password you have (long, real random, sophisticated, but we will get to this later). If it is protected with 2FA, it is still no reason not to use the best password ;) This is what I call the "very high-level password" class.

<div class="separator" style=""><a href="https://z6543.github.io/_img/one-does-not-simply_trust_paypal.png" src="https://z6543.github.io/_img/one-does-not-simply_trust_paypal.png" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="" src="https://z6543.github.io/_img/one-does-not-simply_trust_paypal.png" width="320"/></a></div>
</div><h3>Credit card data</h3></div><div>This system is pretty <strike>fucked up</strike> bad. Something has to be secret (your credit card number), but in the meantime that is the only thing to identify your credit card. It is like your username is your password. Pretty bad idea, huh? The problem is even worse with a <a href="https://twitter.com/mikko/status/236355251966468096" target="_blank">lot of different transaction types</a>, especially when the hotel asks you to fax both sides of your CC to them. Unfortunately, you can't change the password on your credit card, as there is no such thing, but <a href="http://en.wikipedia.org/wiki/3-D_Secure" target="_blank">Verified by VISA or 3-D Secure</a> with 2FA might increase the chances your credit card won't get hacked. And on a side note, I have removed the CVV numbers from my credit/debit cards. I only read it once from the card when I received it, I don't need it anymore to be printed there.
And sometimes, <a href="https://twitter.com/NeedADebitCard" target="_blank">you are your own worst enemy.</a> Don't do stupid things like this:

<div class="separator" style=""><a href="https://z6543.github.io/_img/BgUWxYLCYAEkMQ6.jpg" src="https://z6543.github.io/_img/BgUWxYLCYAEkMQ6.jpg" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="" src="https://z6543.github.io/_img/BgUWxYLCYAEkMQ6.jpg" width="320"/></a></div>
</div><h3></h3><h3>Work related passwords (e.g. Windows domain)</h3><div>This is very important, but because the attack methods are a bit different, I created this as a different category. Details later.

</div><h3>Email, social sites (Gmail/Facebook/Twitter), cloud storage, online shopping</h3><div>This is what I call the "high level password" class.</div><div>Still, pretty important passwords. Some people don't understand "why would attackers put any energy to get his Facebook account?" It is simple. For money. They can use your account to spread spam all over your Facebook wall. They can write messages to all of your connections and tell them you are in trouble and send money via Western Union or Bitcoin.

<div class="separator" style=""><a href="https://z6543.github.io/_img/facebook-scam-travel1.jpg" src="https://z6543.github.io/_img/facebook-scam-travel1.jpg" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="" src="https://z6543.github.io/_img/facebook-scam-travel1.jpg"/></a></div>
They can use your account in Facebook votes. Your e-mail, cloud storage is again very important. 20 years ago you also had letters you didn't want to print and put in front of the nearest store, neither want you to do that with your private photo album. On a side note, it is best to use a cloud storage where even the <a href="https://tresorit.com/" target="_blank">cloud provider admin can't access your data.</a> But in this case, with no password recovery option, better think about "alternative" password recovery mechanisms.

</div><h3></h3><h3>Other important stuff with personal data (e.g. your name, home address)</h3><div>The "medium level password" class. This is a personal preference to have this class or not, but in the long run, I believe it is not a waste of energy to protect these accounts. These sites include your favorite pizza delivery service, your local PC store, etc.

</div><h3></h3><h3>Not important stuff</h3>This is the category other. I usually use <a href="https://www.google.com/?q=one+time+disposable+email+service#q=one+time+disposable+email+service" target="_blank">one-time disposable e-mail</a> to these services. Used for the registration, get what I want, drop the email account. Because I don't want to spread my e-mail address all over the internet, whenever one of these sites get hacked. But still, I prefer to use different, random passwords on these sites, although this is the "low level password" class.
<h2></h2><h2>Attackers and attack methods</h2>After categorizing the different passwords to be protected, let's look at the different attackers and attack methods. They can/will/or actively doing it now:

<h3></h3><h3></h3><h3>Attacking the clear text password </h3>This is the most effective way of getting the password. Bad news is that if there is no other factor of protection, the victim is definitely not on the winning side. The different attack methods are:

<ul><li>phishing sites/applications,</li></ul><div>
</div><div class="separator" style=""></div><div class="separator" style=""><a href="https://z6543.github.io/_img/World-of-Tanks-Hack-5.0.jpg" src="https://z6543.github.io/_img/World-of-Tanks-Hack-5.0.jpg" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="" src="https://z6543.github.io/_img/World-of-Tanks-Hack-5.0.jpg" width="400"/></a></div><div>
</div><ul><li><a href="http://beta.gadgetzz.com/2011/08/15/this-is-the-best-ever-how-a-13-year-old-tried-to-hack-a-steam-account-and-got-hacked/" target="_blank">social engineering,</a></li><li>malware running on the computer (or <a href="http://www.computerworld.com/article/2492866/desktop-apps/researcher-to-demonstrate-feature-rich-malware-that-works-as-a-browser-extension.html" target="_blank">in the browser</a>), </li><li><a href="https://www.youtube.com/watch?v=t9BxB3dO0KQ" target="_blank">shoulder surfing</a> (check out for smartphones, hidden cameras), </li><li>sniffing clear-text passwords when the website is not protected with SSL,</li><li><a href="http://www.hacking-tutorial.com/hacking-tutorial/break-ssl-protection-using-sslstrip-and-backtrack-5/" target="_blank">SSL MiTM</a>,</li><li>rogue website administrator/hacker logging clear text passwords,</li><li>password reuse - if the attacker can get your password in any way, and you reuse it somewhere else, that is a problem,</li><li>you told your password to someone and he/she will misuse it later,</li><li><a href="http://www.keyghost.com/USB-Keylogger.htm" target="_blank">hardware keyloggers,</a></li><li>etc.</li></ul>
The key thing here is that no matter how long your passwords are, no matter how complex it is, no matter how often do you change it (except when you do this every minute ... ), if it is stolen, you are screwed. 2FA might save you, or might not.

<h3></h3><h3></h3><h3>Attacking the encrypted password </h3>This is the usual "hack the webserver (via SQL injection), dump the passwords (with SQLMap), post hashes on pastebin, everybody <a href="http://www.networkworld.com/article/2172637/lan-wan/nvidia-exploit-could-turn-render-farms-into-password-crackers--bitcoin-miners--researchers-c.html" target="_blank">starts the GPU farm</a> to crack the hashes" scenario. This is basically the only scenario where the password policies makes sense. In this case the different level of passwords need different protection levels. In some cases, this attack turns out to be the same as the previous attack, when the passwords are not hashed, or are just encoded.

The current hash cracking speeds for hashes without any iterations (this is unfortunately very common) renders passwords like Q@tCB3nx (8 character, upper-lowercase, digit, special characters) useless, as those can be cracked in hours. Don't believe me? Let's do the math.

Let's say your password is truly random, and randomly choosen from the 26 upper, 26 lower, 10 digit, 33 special characters. (Once I tried special passwords with high ANSI characters inside. It is a terrible idea. Believe me.). There are 6 634 204 312 890 620 different, 8 character passwords from these characters. Assuming a <a href="http://passwords12.at.ifi.uio.no/Jeremi_Gosney_Password_Cracking_HPC_Passwords12.pdf" target="_blank">2 years-old password cracking rig</a>, and MD5 hash cracking with 180 G/s speed, it takes a worst case 10 hours (average 5) to crack the password, <strike>including upgrading your bash to the latest, but still vulnerable bash version.</strike> Had the password been 10 characters long, it would take 10 years to crack with today hardware. But if the password is not truly random, <a href="http://arstechnica.com/security/2013/05/how-crackers-make-minced-meat-out-of-your-passwords/" target="_blank">it can be cracked a lot sooner</a>. 

A lot of common hashing algorithms don't use protections against offline brute-force attacks. This includes LM (old Windows hashes), NTLM (modern Windows hashes), MD-5, SHA1-2-512. These hashing algorithms were not developed for password hashing. They don't have salting, iterations, etc. out of the box. In the case of LM, the problem is even worse, as it converts the lowercase characters to uppercase ones, thus radically decreasing the key space. Out of the box, these hashes are made for fast calculation, thus support fast brute-force.

<div class="separator" style=""><a href="https://z6543.github.io/_img/rig.png" src="https://z6543.github.io/_img/rig.png" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="" src="https://z6543.github.io/_img/rig.png" width="320"/></a></div>
Another attack is when the protected thing is not an online service, but rather an encrypted file or crypto-currency wallet.

<h3></h3><h3></h3><h3>Attacking the authentication system online</h3><div>This is what happened in the recent iCloud hack (besides phishing). Attackers were attacking the authentication system, by either brute-forcing the password, or bypassing the password security by answering the security question. Good passwords can not be brute-forced, as it takes ages. Good security answers have nothing to do with the question in first place. A good security answer is as hard to guess as the password itself. If password recovery requires manual phone calls, I know, it is a bit awkward to say that your first dog name was Xjg.2m`4cJw:V2= , but on the other hand, no one will guess that!

</div><div class="separator" style=""><a href="https://z6543.github.io/_img/sec_questions.png" src="https://z6543.github.io/_img/sec_questions.png" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="" src="https://z6543.github.io/_img/sec_questions.png" width="320"/></a></div><div>
</div><div><h3></h3><h3>Attacking single sign on</h3></div><div>This type of attack is a bit different, as I was not able to put the "<a href="http://en.wikipedia.org/wiki/Pass_the_hash" target="_blank">pass the hash</a>" attacks anywhere. Pass the hash attack is usually found in Windows domain environments, but others might be affected as well. The key thing is single sign on. If you can login to one system (e.g. your workstation), and access many different network resources (file share, printer, web proxy, e-mail, etc.) without providing any password, then something (a secret) has to be in the memory which can be used to to authenticate to the services. If an attacker can access this secret, he will be able to access all these services. The key thing is (again) it does not matter, how complex your passwords are, how long it is, how often do you change, as someone can easily misuse that secret.

</div><div class="separator" style=""></div><div class="separator" style=""></div><div class="separator" style=""></div><div class="separator" style=""></div><div class="separator" style=""><a href="https://z6543.github.io/_img/passthehash.jpg" src="https://z6543.github.io/_img/passthehash.jpg" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="" src="https://z6543.github.io/_img/passthehash.jpg" width="320"/></a></div><h3></h3><h3></h3><h3> </h3><h3>Attacking 2FA</h3><div>As already stated, 2 factor authentication raises the efforts from an attacker point of view, but does not provide 100% protection. </div><div><ul><li>one time tokens (SecurID, Yubikey) can be relayed in a <a href="https://www.youtube.com/watch?v=Bf2nYkn32DM" target="_blank">man-in-the-middle attack</a>, </li><li><a href="http://www.computerworld.com/article/2493077/malware-vulnerabilities/proof-of-concept-malware-can-share-usb-smart-card-readers-with-attackers-ove.html" target="_blank">smartcard authentication can be relayed</a> with the help of a malware to the attacker machine - or simply circumvented in the browser malware, </li><li>text based (SMS) messages can be stolen by <a href="http://www.kaspersky.com/about/news/virus/2011/Teamwork_How_the_ZitMo_Trojan_Bypasses_Online_Banking_Security" target="_blank">malware</a> on the smartphone or rerouted via SS7, </li><li>bio-metric protection is constantly <a href="http://www.ccc.de/en/updates/2013/ccc-breaks-apple-touchid" target="_blank">bypassed</a>,</li><li>SSH keys are constantly <a href="https://www.venafi.com/blog/post/i-hunt-sys-admins-ssh" target="_blank">stolen</a>,</li><li>but U2F keys are pretty good actually, even though BGP/DNS hijack or similar MiTM can still circumvent that protection,</li><li>etc. </li></ul><div>
</div><div class="separator" style=""><a href="https://z6543.github.io/_img/asps1.png" src="https://z6543.github.io/_img/asps1.png" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="" src="https://z6543.github.io/_img/asps1.png"/></a></div><div>
</div></div><h3></h3><h3>Others</h3>Beware that there are tons of other attack methods to access your online account (like XSS/CSRF), but all of these have to be handled on the webserver side. The best you can do is to choose a website where the Bug Bounty program is running 24/7. Otherwise, the website may be full of low hanging, easy-to-hack bugs.

Now that we have covered what we want to protect against what, in the <a href="http://jumpespjump.blogspot.com/2014/10/change-passwords-regularly-myth-and-lie_13.html" target="_blank">next blog post</a>, you will see how to do that. Stay tuned. I will also explain the title of this blog post.