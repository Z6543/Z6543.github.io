---           
layout: post
title: WiFi hacking on tablets
date: 2019-10-08 13:56:42 UTC
updated: 2019-10-08 13:56:42 UTC
comments: false
categories: hacking pwn pad tablet wep
---
<div style=""><a href="http://jumpespjump.blogspot.be/p/disclaimer.html" target="_blank">Disclaimer</a>: Don't hack anything where you don't have the authorization to do so. Stay legal.<br/><br/>Ever since I bought my first Android device, I wanted to use the device for WEP cracking. Not because I need it, but I want it :) After some googling, I read that you can't use your WiFi chipset for packet injection, and I forgot the whole topic.<br/><br/>After a while, I read about hacking on tablets (this was around a year ago), and my first opinion was: </div><div style="">"This is stupid, lame, and the usage of that can be very limited".<br/><br/></div><div style="">After playing one day with it, my opinion just changed: </div><div style="">"This is stupid, lame, the usage is limited, but when it works, it is really funny :-)"<br/><br/>At the beginning I looked at the Pwn Pad as a device that can replace a pentest workstation, working at the attacker side. Boy was I wrong. Pwn Pad should be used as a pentest device deployed at the victim's side!</div><div style=""><br/></div><div style="">You have the following options:</div><div style=""><ol><li>You have 1095 USD + VAT + shipping to buy <a href="https://www.pwnieexpress.com/penetration-testing-vulnerability-assessment-products/sensors/pwn-pad-2014/">this</a> Pwn Pad</li><li>You have around 200 USD to buy an old Nexus 7 tablet, a USB OTG cable, a USB WiFi dongle (e.g. TP-Link Wireless TL-WN722N USB adapter works).</li></ol></div><div style=""><br/><div class="separator" style=""><a href="https://z6543.github.io/_img/2014-04-20+10.48.29_cleaned.jpg" imageanchor="1" src="https://z6543.github.io/_img/2014-04-20+10.48.29_cleaned.jpg" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="" src="https://z6543.github.io/_img/2014-04-20+10.48.29_cleaned.jpg" width="240"/></a></div><br/></div><div style=""><br/></div><div style="">In my example, I bought a used, old 2012 Nexus WiFi. Originally I bought this to play with different custom Android ROMs, and play with rooted applications. After a while, I found this Pwn Pad hype again and gave it a shot.</div><div style=""><br/></div><div style="">The <a href="https://www.pwnieexpress.com/support/downloads/">Pwn Pad community edition</a> has an <a href="http://sourceforge.net/projects/pwnpad/files/?source=navbar">easy-to-use installer</a>, with a proper <a href="http://www.pwnieexpress.com/wp-content/uploads/2013/12/PwnPadCommunityEdition-FactoryImageInstallationGuide.pdf">installation description</a>. Don't forget to backup everything from your tablet before installing Pwn Pad on it!</div><div style=""><br/></div><div style="">I don't want to repeat the install guide, it is as easy as ABC. I booted a Ubuntu Live CD, installed adb and fastboot, and it was ready-to-roll. I have not measured the time, but the whole process was around 20 minutes.<br/><br/></div><div style=""><div class="separator" style=""><a href="https://z6543.github.io/_img/Screenshot_2014-04-17-13-25-13.png" imageanchor="1" src="https://z6543.github.io/_img/Screenshot_2014-04-17-13-25-13.png" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="" src="https://z6543.github.io/_img/Screenshot_2014-04-17-13-25-13.png" width="250"/></a></div><br/></div><div style="">The internal WiFi chipset can be used to sniff traffic or even ARP poisoning for active MiTM. But in my case, I was not able to use the internal chipset for packet injection, which means you can't use it for WEP cracking, WPA disauth, etc. This is where the external USB WiFi comes handy. And this is why we need the Pwn Pad Android ROM, and can't use an average ROM.</div><div style=""><br/>There are two things where Pwn Pad really rocks. The first one is the <u>integrated drivers for</u> the external WiFi with monitor mode and <u>packet injection</u> capabilities. The second cool thing is the <u>chroot wrapper</u> around the Linux hacking tools. Every hacking tool has a start icon, so it feels like it is a native Android application, although it is running in a <u>chroot Kali</u> environment.<br/><br/></div><div style=""><h3>Wifite</h3></div><div style="">The first recommended app is Wifite. Think of it as a wrapper around the aircrack - airmon - airodump suite. My biggest problem with WEP cracking was that I had to remember a bunch of commands, or have the WEP cracking manual with me every time I have to crack it. It was overcomplicated. But thanks to Wifite, that is past.</div><div style=""><br/></div><div style="">In order to crack a WEP key, you have to:<br/><ol><li>Start the Wifite app</li><li>Choose your adapter (the USB WiFi)<br/><br/><div class="separator" style=""><a href="https://z6543.github.io/_img/Screenshot_2014-04-17-13-47-00.png" imageanchor="1" src="https://z6543.github.io/_img/Screenshot_2014-04-17-13-47-00.png" style="margin-left: 1em; margin-right: 1em; text-align: center;"><img border="0" height="" src="https://z6543.github.io/_img/Screenshot_2014-04-17-13-47-00.png" width="320"/></a></div></li><li>Choose the target network (wep_lan in the next example)</li><li>Wait for a minute </li><li>PROFIT!</li></ol></div><div style=""><div class="separator" style=""><a href="https://z6543.github.io/_img/p.png" imageanchor="1" src="https://z6543.github.io/_img/p.png" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="" src="https://z6543.github.io/_img/p.png" width="297"/></a></div><br/></div><div style=""><h3>SSH reverse shell</h3>This is one of the key functionalities of the Pwn Pad. You deploy the tablet at the Victim side, and let the tablet connect to your server via (tunneled) SSH.<br/><br/>The basic concept of the reverse shells are that an SSH tunnel is established between the Pwn Pad tablet (client) and your external SSH server (either directly or encapsulated in other tunneling protocol), and remote port forward is set up, which means on your SSH server you connect to a localport which is forwarded to the Pwn Pad and handled by the Pwn Pad SSH server.<br/><br/>I believe the best option would be to use the reverse shell over 3G, and let the tablet connect to the victim network through Ethernet or WiFi. But your preference might vary. The steps for reverse shells are again well documented in the <a href="http://www.pwnieexpress.com/wp-content/uploads/2013/12/PwnieExpressUserManual-PwnPad.pdf">documentation</a>, except that by default you also have to start the SSH server on the Pwn Pad. It is not hard, there is an app for that ;-) On your external SSH server you might need to install stunnel and ptunnel if you are not using Kali. The following output shows what you can see on your external SSH server after successful reverse shell.<br/><br/><pre class="prettyprint bash">root@myserver:/home/ubuntu# ssh -p 3333 pwnie@localhost<br/>The authenticity of host '[localhost]:3333 ([127.0.0.1]:3333)' can't be established.<br/>ECDSA key fingerprint is 14:d4:67:04:90:30:18:a4:7a:f6:82:04:e0:3c:c6:dc.<br/>Are you sure you want to continue connecting (yes/no)? yes<br/>Warning: Permanently added '[localhost]:3333' (ECDSA) to the list of known hosts.<br/>pwnie@localhost's password:<br/>  _____      ___  _ ___ ___   _____  _____ ___ ___ ___ ___<br/> | _ \ \    / / \| |_ _| __| | __\ \/ / _ \ _ \ __/ __/ __|<br/> |  _/\ \/\/ /| .` || || _|  | _| &gt;  &lt;|  _/   / _|\__ \__ \<br/> |_|   \_/\_/ |_|\_|___|___| |___/_/\_\_| |_|_\___|___/___/<br/><br/> Release Version: 1.5.5<br/> Release Date: 2014-01-30<br/> Copyright 2014 Pwnie Express. All rights reserved.<br/><br/> By using this product you agree to the terms of the Rapid Focus<br/> Security EULA: http://pwnieexpress.com/pdfs/RFSEULA.pdf<br/><br/> This product contains both open source and proprietary software.<br/> Proprietary software is distributed under the terms of the EULA.<br/> Open source software is distributed under the GNU GPL:<br/> http://www.gnu.org/licenses/gpl.html<br/><br/>pwnie@localhost:~$<br/></pre><div><br/>Now you have a shell on a machine that is connected to the victim network. Sweet :) Now Metasploit really makes sense on the tablet, and all other command-line tools.<br/><h3></h3><h3>EvilAP and DSniff</h3>Start EvilAP (it is again a wrapper around airobase), choose interface (for me the Internal Nexus Wifi worked), enter an SSID (e.g freewifi), enter channel, choose whether force all clients to connect to you or just those who really want to connect to you, and start.<br/><br/><div class="separator" style=""><a href="https://z6543.github.io/_img/evilap.png" imageanchor="1" src="https://z6543.github.io/_img/evilap.png" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="" src="https://z6543.github.io/_img/evilap.png" width="250"/></a></div><br/>The next step is to start DSniff, choose interface at0, and wait :) In this example, I used a popular Hungarian webmail, which has a checkbox option for "secure" login (with default off). There are sooo many problems with this approach, e.g. you can't check the certificate before connecting, and the login page is delivered over HTTP, so one can disable the secure login checkbox seamlessly in the background, etc. In this case, I left the "secure" option on default off.<br/><br/><div class="separator" style=""><a href="https://z6543.github.io/_img/dsniff_1.png" imageanchor="1" src="https://z6543.github.io/_img/dsniff_1.png" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="" src="https://z6543.github.io/_img/dsniff_1.png" width="320"/></a></div><br/><div class="separator" style=""><a href="https://z6543.github.io/_img/dsniff2.png" imageanchor="1" src="https://z6543.github.io/_img/dsniff2.png" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="" src="https://z6543.github.io/_img/dsniff2.png" width="320"/></a></div><br/>In the next tutorial, I'm going to show my next favorite app, DSploit ;)<br/><br/><h3>Lessons learned</h3>Hacking has been never so easy before<br/>In a home environment, only use WPA2 PSK<br/>Choose a long, nondictionary passphrase as the password for WPA2<br/>Don't share your WiFi passwords with people you don't trust, or change it when they don't need it anymore<br/>Don't let your client device auto-connect to WiFi stations, even if the SSID looks familiar</div></div><div style=""><br/></div><div style="">I believe during an engagement a Pwn Plug has better "physical cloaking" possibilities, but playing with the Pwn Pad Community Edition really gave me fun moments.<br/><br/>And last but not least I would like to thank to the Pwn Pad developers for releasing the Community Edition!<br/><br/></div>