---           
layout: post
title: Hacking freemium games - the evolution of PC game cheating
date: 2019-10-08 13:45:26 UTC
updated: 2019-10-08 13:45:26 UTC
comments: false
categories: cheating freemium games hacking
---
<div style="text-align: justify;">This post is going to be a rather strange post compared to previous ones. But bear with me, in the middle of the post you will see why this post fits the IT security topic.</div><div style="text-align: justify;"><br/></div><div style="text-align: justify;">I'm also terribly sorry for not posting recently, but I was busy with my <a href="http://www.securitytube-training.com/online-courses/securitytube-python-scripting-expert/" target="_blank">SPSE</a> and <a href="http://www.securitytube-training.com/online-courses/securitytube-linux-assembly-expert/index.html" target="_blank">SLAE</a> certification. Both are recommended for Python and Assembly noobs like me. But back to this post.<br/><br/></div><h2 style="text-align: justify;">A little bit of history</h2><div style="text-align: justify;">Cheating in games started as help for game testers. By using invincibility or infinite ammo testers were able to test the game quicker, which meant less money spent on testing. I personally use cheat codes in games, depending on my mood. Sometimes it feels good to slash all the opponents while I'm invincible, sometimes it is more fun to play the game without cheats. One can argue whether cheating in games is OK or not, but I believe it depends, there is no black or white. But one thing is for sure, it is part of the gaming industry. There is huge demand for cheats. There were even cheat books printed on paper...</div><div style="text-align: justify;"><br/></div><div align="justify"><div class="separator" style="clear: both; text-align: center;"><a href="https://z6543.github.io/_img/cheats10.jpg" src="https://z6543.github.io/_img/cheats10.jpg" style="margin-left: 1em; margin-right: 1em;"><img align="justify" border="0" height="320" src="https://z6543.github.io/_img/cheats10.jpg" width="228"/></a></div></div><div style="text-align: justify;"><br/></div><h2 style="text-align: justify;">The different types of cheats (on PC)</h2><div style="text-align: justify;">There are different types of cheats in PC gaming. Following is a noncomplete list of these cheats:<br/><br/></div><h3 style="text-align: justify;">Cheat codes</h3><div style="text-align: justify;">The good old IDDQD type of cheats. These are left in the game by the developers intentionally. Nothing interesting here.<br/><br/></div><h3 style="text-align: justify;">Edit memory</h3><div style="text-align: justify;">This is my favorite. I will talk about this at the end of the post. Whenever a user launches a new program, the program's whole memory is accessible (read/write) to every other program launched by the user. And since the memory stores the current game state (health, ammo, armor, etc.), these values can be changed easily. In the good old times, there were <a href="http://ready64.it/articoli/_files/043_pokesc64.txt" target="_blank">POKE</a> commands to do this cheats, and the memory address to write into was published by people who found where the game stores the most critical states about the game.<br/><br/></div><div class="separator" style="clear: both; text-align: center;"><a href="https://z6543.github.io/_img/hqdefault.jpg" src="https://z6543.github.io/_img/hqdefault.jpg" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="300" src="https://z6543.github.io/_img/hqdefault.jpg" width="400"/></a></div><h3 style="text-align: justify;"></h3><h3 style="text-align: justify;">Code injection</h3><div style="text-align: justify;">This is like patching the game code. For example, one can change the "DEC (pointer to your current health)" instruction with NOP (do nothing), thus becoming invincible. In multi-player cheats, there is the aimbot to help you aim at enemies, wallhack to see through the wall, increase hitbox of the enemy for smoother hit, or in MMORPGs, one can write macros to collect items while the player is not online. I would say the so-called "<a href="http://en.wikipedia.org/wiki/Trainer_(games)" target="_blank">trainers</a>" more or less fit into this category and the previous one.<br/><br/></div><h3 style="text-align: justify;">Saved game editor</h3><div><div style="text-align: justify;">The first time a kid meets a hex-editor <i>(just like the co-author of this blog did with SIM City when he was 10 years old - David)</i>. It can teach a lot about file structures, the hexadecimal numeral system, etc. Fun times. </div><div style="text-align: justify;"><br/></div></div><h3 style="text-align: justify;">Hacking game server</h3><div><div style="text-align: justify;">Not very common, but even more fun. Warning: endless trolling possibilities in multi-player games ahead :) How to hack a game server? Well, I think this might deserve another full blog post ...</div><div style="text-align: justify;"><br/></div></div><h3 style="text-align: justify;">Network traffic hacking</h3><div><div style="text-align: justify;">One last necessary type of cheating is to modify network traffic between the client and the game server. AFAIK SSL is not universal in gaming, so stunnel is not needed for this hack, but ettercap can help in changing the communication.</div></div><div style="text-align: justify;"><br/></div><h2 style="text-align: justify;">Why cheating becomes more critical (and challenging)?</h2><div style="text-align: justify;">Now in the age of in-app-payments, the game creators are no longer thinking about cheats as funny things but something to be destroyed to the ground. Because cheating decreases its revenue. Or not. At least they think it does. To quote Wikipedia here, "cheating in such games is nonetheless a legal grey area because there are no laws against modifying software which is already owned, as detailed in the Digital Millennium Copyright Act." </div><div style="text-align: justify;"><br/></div><div style="text-align: justify;">A lot of online games include anti-cheating components like PunkBuster, nProtect GameGuard, or Valve Anti-Cheat. This whole cheating/anti-cheating industry is the same as the virus/anti-virus industry. A cat and mouse game.<br/><br/></div><h3 style="text-align: justify;">Freemium games</h3><div style="text-align: justify;">If you have not played with "freemium" games, you should watch South Park season 18, episode 6. - "Freemium Isn't Free." If you did play with freemium games, you definitely have to watch it :) There are many problems with freemium games. It is free to install, free to play. The first 3-4 hours might be fun to play. But after that, it turns out it is impossible to advance in the game without paying money for it. And by spending cash, I mean spending a LOT! Let's have a look at today's example, an arcade racing video game.</div><div style="text-align: justify;"><br/></div><div class="separator" style="clear: both; text-align: center;"><a href="https://z6543.github.io/_img/asphalt1.png" src="https://z6543.github.io/_img/asphalt1.png" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="267" src="https://z6543.github.io/_img/asphalt1.png" width="640"/></a></div><div style="text-align: justify;"><br/></div><div style="text-align: justify;">For 99.99 USD, you can get 3 000 000 credit. For almost double the price of a new PC game, you can get these credits. In this particular game, I estimate one have to play ~6-24 hours constantly to get this amount of credit. But by playing ~6 hours, I mean 6 hours without progress in the game! Kind of boring. And what do you get from 3 000 000 credit? You can buy one of the most expensive cars, but can't tune them fully. You have to play more (without progress) or buy more. But guess what, there are more cars you can't buy by only playing the game. Those are only available via in-app-purchase.<br/><br/></div><div class="separator" style="clear: both; text-align: center;"><a href="https://z6543.github.io/_img/asphalt2.png" src="https://z6543.github.io/_img/asphalt2.png" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="271" src="https://z6543.github.io/_img/asphalt2.png" width="400"/></a></div><div style="text-align: justify;"><br/></div><div style="text-align: justify;">Even though the player has 58 765 533 credits, it is not possible to buy this car. Only available through real money.<br/><br/></div><div class="separator" style="clear: both; text-align: center;"><a href="https://z6543.github.io/_img/asphalt3.png" src="https://z6543.github.io/_img/asphalt3.png" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="181" src="https://z6543.github.io/_img/asphalt3.png" width="400"/></a></div><div style="text-align: justify;"><br/></div><div style="text-align: justify;">So, what are your possibilities? You are either Richie Rich, and can afford the money to buy these. Or you can be insane, and try to play the game without in-app-purchase. Or give up the game and try another freemium ... Or, you can try to hack the game!<br/><br/></div><h2 style="text-align: justify;">Hack all the freemium games!</h2><div style="text-align: justify;">Although I was not playing this racing game from day one, I was able to witness the evolution of the cheats against this game. The cheats which worked in one day was not working one month later. The game is continuously updated to defeat the newly published cheats.<br/><br/></div><h3 style="text-align: justify;">Noob start</h3><div style="text-align: justify;">So, I want to hack this game, what is the first thing a noob like me does? <strike>Bing it!</strike> Google it! </div><div style="text-align: justify;">From the first page result, let's check this tool:</div><div class="separator" style="clear: both; text-align: justify;"><br/></div><div class="separator" style="clear: both; text-align: center;"><a href="https://z6543.github.io/_img/Asphalt-8-Airborne-Hack-Tool-Screenshot.png" src="https://z6543.github.io/_img/Asphalt-8-Airborne-Hack-Tool-Screenshot.png" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="400" src="https://z6543.github.io/_img/Asphalt-8-Airborne-Hack-Tool-Screenshot.png" width="390"/></a></div><div class="separator" style="clear: both; text-align: justify;"><br/></div><div class="separator" style="clear: both; text-align: justify;">While trying to download that, I just have to give my email address to spammers, or my mobile number will be subscribed to premium rate text messages. What fun.</div><div class="separator" style="clear: both; text-align: justify;"><br/></div><div class="separator" style="clear: both; text-align: center;"><a href="https://z6543.github.io/_img/asphalt4.png" src="https://z6543.github.io/_img/asphalt4.png" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="313" src="https://z6543.github.io/_img/asphalt4.png" width="400"/></a></div><div style="text-align: justify;"><br/></div><div style="text-align: justify;">Another "cheat" program will install malware/adware on your computer. <b><u><span style="color: red;">Never ever try these programs.</span></u></b> They are fake 99% of the time and after installing those you will have another problem, not just how to hack freemium games.<br/><br/></div><h3 style="text-align: justify;">Beginners start - Cheat engine</h3><div><span style="text-align: justify;">When I first heard about hacking games in memory, I visualized hours of OllyDBG/ImmunityDBG/(insert your favorite Windows debugger here). It turned out, there are some specialized tools to help you with cheating the game. No assembly knowledge required. My favourite tool is </span><a href="http://www.cheatengine.org/downloads.php" style="text-align: justify;" target="_blank">CheatEngine</a><span style="text-align: justify;">. I highly recommend to download it and spend 10 minutes to get past the built-in tutorial levels to get a feeling about this tool. It's super duper awesome.</span><br/><span style="text-align: justify;"><br/></span></div><div class="separator" style="clear: both; text-align: center;"><a href="https://z6543.github.io/_img/cheat.png" src="https://z6543.github.io/_img/cheat.png" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="468" src="https://z6543.github.io/_img/cheat.png" width="640"/></a></div><div><span style="text-align: justify;"><br/></span></div><div><span style="text-align: justify;"><br/></span></div><div><div style="text-align: justify;">When I first tried to hack this game myself, I scanned the memory for my actual credit and tried to change that, no luck. Keep reading, you will see what happened.<br/><br/>The second cheat I tried with cheat engine was <a href="https://www.youtube.com/watch?v=kz9k4vOpns0" target="_blank">something like this</a>: </div></div><div><ol><li style="text-align: justify;">Start the game, play the first level, and check how many credits is paid for winning the race. Pro tip: use dual display for full-screen game cheating.</li><li style="text-align: justify;">Restart the same level, attach Cheat Engine to the game's process</li><li style="text-align: justify;">Scan the memory for the same value at the beginning of the race</li><li style="text-align: justify;">Scan the memory for the same value at the end of the game. The intersect of the first and second scan includes the real value where the credit is stored for winning the race.</li><li style="text-align: justify;">Change the values (both the real one and some false positives) to something big</li><li style="text-align: justify;">Watch the game to crash</li><li style="text-align: justify;">Be amazed at the money you received</li></ol><div><div style="text-align: justify;">Nowadays, most of the cheats on YouTube does not work. Except for these <a href="https://www.youtube.com/watch?v=f5a3CGVLwAI" target="_blank">kind of cheats</a>. I don't want to recreate that tutorial, so you should watch it first then come back.<br/><br/><div class="separator" style="clear: both; text-align: center;"><a href="https://z6543.github.io/_img/asphalt5.png" src="https://z6543.github.io/_img/asphalt5.png" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="640" src="https://z6543.github.io/_img/asphalt5.png" width="616"/></a></div><br/><br/></div></div></div><div><div style="text-align: justify;">Are you back? Great. Do you have any idea what have you just seen? No? Well, in this case, don't try this at home. Copy-pasting <a href="http://blog.zoller.lu/2009/07/0pen0wnc-shellcode-dissasembled.html" target="_blank">assembly code from random internet posts</a> and running on your computer is always a bad idea. It is precisely as risky as downloading free programs from random internet sites.<br/><br/>Although I have not seen people trolling others with this cheat engine type of shellcode, I think the time will come when these will be turned into something terrible. These shellcodes might work, or might harm your computer. The good news is, we can have a look at the code and analyze it. </div></div><div><div style="text-align: justify;"><br/></div></div><div><div style="text-align: justify;">When you open CheatEngine and try to define a new custom type, you are greeted with a skeleton assembly code. I don't want to detail what all the skeleton code does, let's just focus on the difference between the skeleton code and the code used in the video. This is the "decrypt function":</div></div><div><div style="text-align: justify;"><br/></div></div><pre class="prettyprint">xor eax, 0baadf00d<br/>rol eax, 0e<br/></pre><div style="text-align: justify;"><br/></div><div><div style="text-align: justify;">What does it mean? The actual credit is encrypted in memory. If you want to scan it in memory, you won't be able to find it. But! The encryption is rotating the value to the right (ROR) with 0xE (14 in decimal), and after that, it is XOR-ed with 0xbaadf00d. Decrypting it is the inverse of the functions in reverse order (in this particular case, the order does not matter, but that's not the point). The inverse function of XOR is XOR, and the inverse function of ROR (rotate right) is ROL (rotate left). Now that we analyzed the assembly code, we can be sure that it is safe to execute. Just follow the video and see your coins falling from the sky. For free. In a freemium game. Have fun!<br/><br/><h3>Encrypt memory - applications at financial institutions</h3></div><div style="text-align: justify;">Another exciting thing is that I don't recall any thick client applications in the financial industry encrypting the values in memory. And I agree, there are more significant problems with thick client applications than not encrypting the essential values in memory. But still, some thick client applications are regularly updated, maintained. Maybe it is a good idea to encrypt the values in memory. It will make attackers' life harder. Not impossible, but harder. Perhaps the developers of these applications should learn from the gaming industry (or from malware developers for that matter) because it is a shame that an arcade racing game or an FPS is protected better than an application responsible for transacting millions of dollars. Just think about the RAM scraping malware stealing millions of credit card data ...<br/><br/></div><h2 style="text-align: justify;">Moral of the story</h2></div><div style="text-align: justify;">Cheating is part of the gaming history, and the freemium games are trying to take away the cheats from the gamers because they want money. Thanks to CheatEngine and some clever hacks, these programs can be still beaten. And guess what, there is CheatEngine for Android - although it did not work for me on the latest Android. And sometimes, hacking all kinds of applications can be more comfortable with CheatEngine, compared to traditional debuggers.<br/><br/>Also, always check the code before executing it! And when you find something cool, publish it, so everyone could enjoy the games!<br/><br/><br/></div>