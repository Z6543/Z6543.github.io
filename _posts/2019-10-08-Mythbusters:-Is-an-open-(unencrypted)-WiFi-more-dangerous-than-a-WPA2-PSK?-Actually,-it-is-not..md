---           
layout: post
title: Mythbusters: Is an open (unencrypted) WiFi more dangerous than a WPA2-PSK? Actually, it is not.
date: 2019-10-08 13:37:15 UTC
updated: 2019-10-08 13:37:15 UTC
comments: false
categories: VPN wifi wireless WPA2 WPA2-PSK
---
<h2>Introduction</h2><div><br/></div><div style="">Whenever security professionals recommend the 5 most important IT security practices to average users, one of the items is usually something like: “Avoid using open Wifi” or “Always use VPN while using open WiFi” or “Avoid sensitive websites (e.g. online banking) while using open WiFI”, etc.</div><div style=""><br/></div><div style="">What I think about this? It is bullshit. But let’s not jump to the conclusions. Let’s analyze all risks and factors here.</div><div class="separator" style=""><a href="https://z6543.github.io/_img/chive-thursday-29.jpg" imageanchor="1" src="https://z6543.github.io/_img/chive-thursday-29.jpg" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="" src="https://z6543.github.io/_img/chive-thursday-29.jpg" width="270"/></a></div><br/><br/><div style="">During the following analysis, I made two assumptions. The first one is that we are comparing public WiFi hotspots with no encryption at all (referred to as Open), and we compare this to public WiFi hotspots with WPA2-PSK (and just hope WEP died years before). The other assumption is there are people who are security-aware, and those who just don’t care. They just want to browse the web, access Facebook, write e-mails, etc.</div><br/><h3>The risks</h3><div><br/></div><div style="">Let’s discuss the different threats people face using public hotspots, compared to home/work internet usage:</div><div style="">1.<span class="Apple-tab-span" style="white-space: pre;"> </span>Where the website session data is not protected with SSL/TLS (and the cookie is not protected with secure flag), attackers on the same hotspot can obtain the session data and use it in session/login credentials stealing. Typical protocols affected:</div><div style=""><br/></div><ul><li style="text-align: justify;">HTTP sites</li><li style="text-align: justify;">HTTPS sites but unsecured cookie</li><li style="text-align: justify;">FTP without encryption</li><li style="text-align: justify;">IMAP/SMTP/POP3 without SSL/TLS or STARTTLS</li></ul><div style=""><br/></div><div style="">2.<span class="Apple-tab-span" style="white-space: pre;"> </span>Attackers can inject extra data into the HTTP traffic, which can be used for exploits, or social engineer attacks (e.g. update Flash player with our malware) – see the <a href="https://securelist.com/files/2014/11/darkhotel_kl_07.11.pdf" target="_blank">Dark Hotel campaign</a></div><div style=""><br/></div><div style="">3.<span class="Apple-tab-span" style="white-space: pre;"> </span>Attackers can use tools like SSLStrip to keep the user’s traffic on clear text HTTP and steal password/session data/personal information</div><div style=""><br/></div><div style="">4.<span class="Apple-tab-span" style="white-space: pre;"> </span>Attackers can monitor and track user activity</div><div style=""><br/></div><div style="">5.<span class="Apple-tab-span" style="white-space: pre;"> </span>Attackers can directly attack the user’s machine (e.g. SMB service)</div><br/><h3>WPA2-PSK security</h3><br/><div style="">So, why is a public WPA2-PSK WiFi safer than an open WiFi? Spoiler alert: it is not!</div><div style=""><br/></div><div style="">In a generic public WPA2-PSK scenario, all users share the same password. And guess what, the whole traffic can be decrypted with the following information: SSID + shared password + information from the 4-way handshake. <a href="https://wiki.wireshark.org/HowToDecrypt802.11">https://wiki.wireshark.org/HowToDecrypt802.11</a></div><div style="">If you want to see it in action, here is a nice tutorial for you</div><div style=""><a href="http://www.lovemytool.com/blog/2010/05/wireshark-and-tshark-decrypt-sample-capture-file-by-joke-snelders.html">http://www.lovemytool.com/blog/2010/05/wireshark-and-tshark-decrypt-sample-capture-file-by-joke-snelders.html</a></div><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="https://z6543.github.io/_img/6a00e008d95770883401348056c1d8970c.png" imageanchor="1" src="https://z6543.github.io/_img/6a00e008d95770883401348056c1d8970c.png" style="margin-left: auto; margin-right: auto;"><img border="0" height="" src="https://z6543.github.io/_img/6a00e008d95770883401348056c1d8970c.png" width="400"/></a></td></tr><tr><td class="tr-caption" style="text-align: center;">Decrypted WPA2-PSK traffic</td></tr></tbody></table><br/><div style="">Any user having access to the same WPA2-PSK network knows this information. So they can instantly decrypt your traffic. Or the attackers can just set up an access point with the same SSID, same password, and stronger signal. And now, the attacker can instantly launch active man-in-the-middle attacks. It is a common belief (even among ITSEC experts) that WPA2-PSK is not vulnerable to this attack. I am not sure why this vulnerability was left in the protocol, if you have the answer, let me know. Edit (2015-08-03): I think the key message here is that without server authentication (e.g. via PKI), it is not possible to solve this.</div><div style="">Let me link here one of my previous posts here with a great skiddie tool:</div><div style=""><a href="http://jumpespjump.blogspot.nl/2014/04/dsploit.html">http://jumpespjump.blogspot.nl/2014/04/dsploit.html</a></div><div style=""><br/></div><div style="">To sum up, attackers on a WPA2-PSK network can:</div><div style=""><br/></div><ul><li style="text-align: justify;">Decrypt all HTTP/FTP/IMAP/SMTP/POP3 passwords or other sensitive information</li><li style="text-align: justify;">Can launch active attacks like SSLStrip, or modify HTTP traffic to include exploit/social engineer attacks</li><li style="text-align: justify;">Can monitor/track user activity</li></ul><div style=""><br/></div><div style="">The only difference between open and WPA2-PSK networks is that an open network can be hacked with an attacker of the skill level of 1 from 10, while the WPA2-PSK network needs and an attacker with a skill level of 1.5. That is the difference.</div><br/><h3>The real solutions</h3><div><br/></div><br/><div style="">1.<span class="Apple-tab-span" style="white-space: pre;"> </span>Website owners, service providers should deploy proper (trusted) SSL/TLS infrastructure, protect session cookies, etc. Whenever a user (or security professional) notices a problem with the quality of the service (e.g. missing SSL/TLS), the service provider has to be notified. If no change is made, it is recommended to drop the service provider and choose a more secure one. Users have to use HTTPS Everywhere plugin.</div><div style=""><br/></div><div style="">2.<span class="Apple-tab-span" style="white-space: pre;"> </span>Protect the device against exploits by patching the software on it, use a secure browser (Chrome, IE11 + enhanced protection), disable unnecessary plugins (Java, Flash, Silverlight), or at least use it via click-to-play. Also, the use of exploit mitigations tools (EMET, HitmanPro Alert, Malwarebytes AntiExploit) and a good internet security suite is a good idea.</div><div style=""><br/></div><div style="">3.<span class="Apple-tab-span" style="white-space: pre;"> </span>Website owners have to deploy <a href="https://en.wikipedia.org/wiki/HTTP_Strict_Transport_Security" target="_blank">HSTS</a>, and optionally include their site in an <a href="https://hstspreload.appspot.com/" target="_blank">HSTS preload list</a></div><div style=""><br/></div><div style="">4.<span class="Apple-tab-span" style="white-space: pre;"> </span>Don’t click blindly on fake downloads (like fake Flash Player updates)</div><div class="separator" style=""><a href="https://z6543.github.io/_img/scandesk.jpg" imageanchor="1" src="https://z6543.github.io/_img/scandesk.jpg" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="" src="https://z6543.github.io/_img/scandesk.jpg" width="400"/></a></div><br/><br/><div style="">5.<span class="Apple-tab-span" style="white-space: pre;"> </span>The benefits of a VPN is usually overestimated. A VPN provider is just another provider, like the hotspot provider, or the ISP. They can do the same malicious stuff (traffic injecting, traffic monitoring, user tracking). Especially when people use free VPNs. And “Average Joe” will choose a free VPN. Also, VPN connections tend to be disconnected, and almost none of the VPN providers provide fail secure VPNs. Also, for the price of a good VPN service you can buy a good data plan and use 4G/3G instead of low-quality public hotspots. But besides this, on mobile OSes (Android, iOS, etc.) I strongly recommend the use of VPN, because it is not practically feasible to know for users which app is using SSL/TLS and which is not.</div><div style=""><br/></div><div style="">6.<span class="Apple-tab-span" style="white-space: pre;"> </span>Use a location-aware firewall, and whenever the network is not trusted, set it to a Public.</div><div class="separator" style=""><a href="https://z6543.github.io/_img/2251.clip_image001_627A00E5.png" imageanchor="1" src="https://z6543.github.io/_img/2251.clip_image001_627A00E5.png" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="" src="https://z6543.github.io/_img/2251.clip_image001_627A00E5.png" width="320"/></a></div><br/><div style="">7.<span class="Apple-tab-span" style="white-space: pre;"> </span>In a small-business/home environment, buy a WiFi router with guest WiFi access possibility, where the different passwords can be set to guest networks than used for the other.</div><div style=""><br/></div><div style="">Asking the question “Are you using open WiFi?”, or “Do you do online banking on open WiFi?” are the wrong questions. The good questions are:</div><ul><li style="text-align: justify;">Do you trust the operator(s) of the network you are using?</li><li style="text-align: justify;">Are the clients separated?</li><li style="text-align: justify;">If clients are not separated, is it possible that there are people with malicious intent on the network?</li><li style="text-align: justify;">Are you security-aware, and are you following the rules previously mentioned? If you do follow these rules, those will protect you on whatever network you are.</li></ul><div style=""><br/></div><div style="">And call me an idiot, but I do online banking, e-shopping, and all the other sensitive stuff while I’m using open WiFi. And whenever I order pizza from an HTTP website, attackers can learn my address. Which is already in the phone book, on Facebook, and in every photo metadata I took with my smartphone about my cat and uploaded to the Internet (<a href="http://iknowwhereyourcatlives.com/">http://iknowwhereyourcatlives.com/</a>).</div><div class="separator" style=""><a href="https://z6543.github.io/_img/cat.png" imageanchor="1" src="https://z6543.github.io/_img/cat.png" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="" src="https://z6543.github.io/_img/cat.png" width="320"/></a></div><br/><br/><div style="">Most articles and research publications are full of FUD about what people can learn from others. Maybe they are just outdated, maybe they are not. But it is totally safe to use Gmail on an open WiFi, no one will be able to read my e-mails.</div><div style=""><br/></div><div style="">PS: I know “Average Joe” won’t find my blog post, won’t start to read it, won’t understand half I wrote. But even if they do, they won’t patch their browser plugins, pay for a VPN, or check the session cookie. So they are doomed to fail. That’s life. Deal with it.</div><div><br/></div>