---           
layout: post
title: DNSSEC, from an end-user perspective, part 3
date: 2019-10-08 15:55:35 UTC
updated: 2019-10-08 15:55:35 UTC
comments: false
categories: DNS hijack DNS spoofing DNSSEC
---
<div style="">In the <a href="http://jumpespjump.blogspot.hu/2013/12/dnssec-from-end-user-perspective-part-1.html" target="_blank">first post</a> of this DNSSEC series, I have shown the problem (DNS vulnerabilities), and in the <a href="http://jumpespjump.blogspot.hu/2014/01/dnssec-from-end-user-perspective-part-2.html" target="_blank">second post</a>, the "solution." In this third post, I am going to analyze DNSSEC. Can DNSSEC protect the users against all of the attacks? Or just part of them? What about corner cases?</div><br/>The following list are the attack types from the <a href="http://jumpespjump.blogspot.hu/2013/12/dnssec-from-end-user-perspective-part-1.html" target="_blank">first post</a>, where DNSSEC <u><b>can</b></u> protect the users:<br/><br/><ul><li>DNS cache poisoning the DNS server, "Da Old way"</li><li>DNS cache poisoning, "<a href="http://www.iana.org/about/presentations/davies-viareggio-entropyvuln-081002.pdf" target="_blank">Da Kaminsky way</a>"</li><li>ISP hijack, for advertisement or spying purposes</li><li>Captive portals</li><li>Pentester hijacks DNS to test application via active man-in-the-middle</li><li>Malicious attacker hijacks DNS via active MITM</li></ul><br/>The following list are the attack types from the <a href="http://jumpespjump.blogspot.hu/2013/12/dnssec-from-end-user-perspective-part-1.html" target="_blank">first post</a>, where DNSSEC <u style="font-weight: bold;">cannot</u> protect the users:<br/><br/><ul><li>Rogue DNS server set via malware</li><li>Having access to the DNS admin panel and rewriting the IP</li><li>ISP hijack, for advertisement or spying purposes</li><li>Captive portals</li><li>Pentester hijacks DNS to test application via active man-in-the-middle</li><li>Malicious attacker hijacks DNS via active MITM</li></ul><br/><div style="">If you are a reader who thinks while reading, you might say "What the hell? Am I protected or not???". The problem is that it depends… In the case where the attacker is between you and your DNS server, the attacker can impersonate the DNS server, downgrade it to a non DNSSEC aware one, and send responses without DNSSEC information.</div><div><br/></div><div>Now, how can I protect against all of these attacks? Answer is "simple":</div><div><ol><li>Configure your own DNSSEC aware server on your localhost, and use that as a resolver. This is pretty easy, even I was able to do it <a href="http://www.howtoforge.com/configuring-dnssec-on-bind9-9.7.3-on-debian-squeeze-ubuntu-11.10" target="_blank">using tutorials</a>.</li><li>Don't let malware run on your system! ;-)</li><li>Use at least two-factor authentication for admin access of your DNS admin panel.</li><li>Use a registry lock (details in <a href="http://jumpespjump.blogspot.hu/2013/12/dnssec-from-end-user-perspective-part-1.html" target="_blank">part 1</a>).</li><li>Use a DNSSEC aware OS.</li><li>Use DNSSEC protected websites.</li><li>There is a need for an API or something, where the client can enforce DNSSEC protected answers. In case the answer is not protected with DNSSEC, the connection can not be established.</li></ol><div><div><br/></div><div>Now some random facts, thoughts, solutions around DNSSEC:</div><div><ul><li>Did you know .SE signed its zone with DNSSEC in September 2005, as the first TLD in the world?</li><li>Did you know DNSSEC was first deployed at the root level on July 15, 2010?</li><li>Did you know <a href="https://xs.powerdns.com/dnssec-nl-graph/" target="_blank">.NL become the first TLD to pass 1 million DNSSEC-signed domain names</a>?</li><li>Did you know that <a href="http://deneb.iszt.hu/dnssec-hu/" target="_blank">Hungary is in the testing phase of DNSSEC</a> (watch out, it is Hungarian)?</li><li>Did you know that <a href="https://addons.mozilla.org/en-us/firefox/addon/dnssec-validator/" target="_blank">you can also use and test that cool DNSSEC validator</a>?</li><li>Did you know that <a href="http://www.opendns.com/about/innovations/dnscrypt/" target="_blank">there are alternative solutions like DNSCrypt</a>?</li><li>Did you know that in the future you might be able to enforce <a href="http://en.wikipedia.org/wiki/HTTP_Strict_Transport_Security" target="_blank">HSTS</a> via DNSSEC?</li><li>Did you know that in the future you might be able to use <a href="http://en.wikipedia.org/wiki/DNS-based_Authentication_of_Named_Entities" target="_blank">certificate pinning via DNSSEC</a>?</li></ul></div></div><div><br/></div>That's all folks, happy DNSSEC configuring ;-)</div><div><br/></div><div style=""><b>Note from David</b>:</div><div style="">Huh, I have just accidentally deleted this whole post from Z, but then I got it back from my browsing cache. Big up to Nir Sofer for his <a href="http://www.nirsoft.net/utils/chrome_cache_view.html" target="_blank">ChromeCacheView</a> tool! Saved my ass from kickin'! :D</div>