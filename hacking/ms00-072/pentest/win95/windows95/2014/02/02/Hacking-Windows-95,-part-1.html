<!DOCTYPE html>
<html class="direction--ltr"lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Hacking Windows 95, part 1 | Jump ESP, jump!</title>
<meta name="generator" content="Jekyll v4.0.1" />
<meta property="og:title" content="Hacking Windows 95, part 1" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="During a CTF game, we came across very-very old systems. Turns out, it is not that easy to hack those dinosaur old systems, because modern tools like Metasploit do not have sploits for those old boxes and of course our &quot;133t h4cking skillz&quot; are useless without Metasploit... :) But I had an idea: This can be a pretty good small research for fun. The rules for the hack are the following: Only publicly available tools can be used for this hack, so no tool development. This is a CTF for script bunniez, and we can&#39;t haz code!Only hacks without user interaction are allowed (IE based sploits are out of scope).I need instant remote code execution. For example, if I can drop a malware to the c: drive, and change autoexec.bat, I&#39;m still not done, because no one will reboot the CTF machine in a real CTF for me. If I can reboot the machine, that&#39;s OK.I don&#39;t have physical access. I have chosen Windows 95 for this task. First, I had to get a genuine Windows 95 installer, so I visited the Microsoft online shop and downloaded it from their official site. I installed it in a virtualized environment (remember, you need a boot floppy to install from the CD), and it hit me with a serious nostalgia bomb after watching the installer screens. &quot;Easier to use&quot;, &quot;faster and more efficient&quot;, &quot;high-powered performance&quot;, &quot;friendly&quot;, &quot;intuitive interface&quot;. Who does not want that? :) Now that I have a working Windows 95 box, setting up the TCP/IP is easy, let&#39;s try to hack it! My first tool is always nmap. Let&#39;s scan the box! Below I&#39;m showing the interesting parts from the result: PORT STATE SERVICE VERSION 139/tcp open netbios-ssn 137/udp open|filtered netbios-ns 138/udp open|filtered netbios-dgm Running: Microsoft Windows 3.X|95 OS details: Microsoft Windows for Workgroups 3.11 or Windows 95 TCP Sequence Prediction: Difficulty=25 (Good luck!) IP ID Sequence Generation: Broken little-endian incremental The first exciting thing to note is that there is no port 445! Port 445 is only since NT 4.0. If you check all the famous windows sploits (e.g., MS03-026, MS08-067), all of them use port 445 and named pipes. But there are no named pipes on Windows 95! Because I&#39;m a Nessus monkey, let&#39;s run a free Nessus scan on it! Only one critical vulnerability found: Microsoft Windows NT 4.0 Unsupported Installation Detection Thanks for nothing, Nessus! But at least it was for free. Next, I tried GFI Languard, nothing. It detected the machine as Win95, the opened TCP port, and some UDP ports as open (false-positive), and that&#39;s all... Let&#39;s try another free vulnerability scanner tool, Nexpose. The results are much better: CIFS NULL Session Permitted  Weak LAN Manager hashing permitted SMB signing not required Windows 95/98/ME Share Level Password Bypass   TCP Sequence Number Approximation Vulnerability  ICMP netmask response CIFS Share Readable By Everyone I think the following vulnerabilities are useless for me at the moment: Weak LAN Manager hashing permitted - without user interaction or services looking at the network, useless (I might be wrong here, will check this later) TCP Sequence Number Approximation Vulnerability - not interestingICMP netmask response - not interestingCIFS Share Readable By Everyone - unless there is a password in a text file, useless But we have two interesting vulns: CIFS NULL Session Permitted  - this could be interesting, I will check this later ...Windows 95/98/ME Share Level Password Bypass - BINGO! Let me quote Nexpose here: &quot;3.2.3 Windows 95/98/ME Share Level Password Bypass (CIFS-win9x-onebyte-password) A flaw in the Windows 95/98/ME File and Print Sharing service allows unauthorized users to access file and print shares by sending the first character of the password. Due to the limited number of attempts required to guess the password, brute force attacks can be performed in just a few seconds. Established connection to share TEST with password P.&quot; The vulnerability description at MS side: http://technet.microsoft.com/en-us/security/bulletin/ms00-072 For example if the password is &quot;Password&quot; (without quotes) and the client sends the password &quot;P&quot; (without quotes) and the length of 1, the client is authenticated. To find the rest of the password, the attacker increments the length to 2 and starts guessing the second letter until he reaches &quot;PA&quot; and gets authenticated again. As share passwords in Windows 95 are not case sensitive, &quot;Pa&quot; and &quot;PA&quot; will also be accepted. The attacker can continue to increment the length and guessing the next letter one-by-one until he gets the full &quot;PASSWORD&quot; (as the maximum length is 8 characters).I believe all characters between ALT+033 and ALT+255 can be used in the share password in Windows 95, but as it is case insensitive, we have 196 characters to use, and a maximum length of 8 characters. In worst case this means that we can guess the full password in 1568 requests. The funny thing is that the share password is not connected to (by default) any username/account, and it cannot be locked via brute force. Luckily there is a great tool which can exploit this vulnerability: Share Password Checker Let&#39;s check this tool in action: W00t w00t, it brute forced the password in less then 2 seconds! Looking at a wireshark dump we can see how it is done: As you can see, in the middle of the dump we can see that it already guessed the part &quot;PASS&quot; and it is brute-forcing the fifth character, it founds that &quot;W&quot; is the correct fifth character, and starts brute-forcing the sixth character. If we are lucky with the CTF, the whole C:\ drive is shared with full read-write access, and we can write our team identifier into the c:\flag.txt. But what if we want remote code execution? Stay tuned, this is going to be the topic of the next part of this post." />
<meta property="og:description" content="During a CTF game, we came across very-very old systems. Turns out, it is not that easy to hack those dinosaur old systems, because modern tools like Metasploit do not have sploits for those old boxes and of course our &quot;133t h4cking skillz&quot; are useless without Metasploit... :) But I had an idea: This can be a pretty good small research for fun. The rules for the hack are the following: Only publicly available tools can be used for this hack, so no tool development. This is a CTF for script bunniez, and we can&#39;t haz code!Only hacks without user interaction are allowed (IE based sploits are out of scope).I need instant remote code execution. For example, if I can drop a malware to the c: drive, and change autoexec.bat, I&#39;m still not done, because no one will reboot the CTF machine in a real CTF for me. If I can reboot the machine, that&#39;s OK.I don&#39;t have physical access. I have chosen Windows 95 for this task. First, I had to get a genuine Windows 95 installer, so I visited the Microsoft online shop and downloaded it from their official site. I installed it in a virtualized environment (remember, you need a boot floppy to install from the CD), and it hit me with a serious nostalgia bomb after watching the installer screens. &quot;Easier to use&quot;, &quot;faster and more efficient&quot;, &quot;high-powered performance&quot;, &quot;friendly&quot;, &quot;intuitive interface&quot;. Who does not want that? :) Now that I have a working Windows 95 box, setting up the TCP/IP is easy, let&#39;s try to hack it! My first tool is always nmap. Let&#39;s scan the box! Below I&#39;m showing the interesting parts from the result: PORT STATE SERVICE VERSION 139/tcp open netbios-ssn 137/udp open|filtered netbios-ns 138/udp open|filtered netbios-dgm Running: Microsoft Windows 3.X|95 OS details: Microsoft Windows for Workgroups 3.11 or Windows 95 TCP Sequence Prediction: Difficulty=25 (Good luck!) IP ID Sequence Generation: Broken little-endian incremental The first exciting thing to note is that there is no port 445! Port 445 is only since NT 4.0. If you check all the famous windows sploits (e.g., MS03-026, MS08-067), all of them use port 445 and named pipes. But there are no named pipes on Windows 95! Because I&#39;m a Nessus monkey, let&#39;s run a free Nessus scan on it! Only one critical vulnerability found: Microsoft Windows NT 4.0 Unsupported Installation Detection Thanks for nothing, Nessus! But at least it was for free. Next, I tried GFI Languard, nothing. It detected the machine as Win95, the opened TCP port, and some UDP ports as open (false-positive), and that&#39;s all... Let&#39;s try another free vulnerability scanner tool, Nexpose. The results are much better: CIFS NULL Session Permitted  Weak LAN Manager hashing permitted SMB signing not required Windows 95/98/ME Share Level Password Bypass   TCP Sequence Number Approximation Vulnerability  ICMP netmask response CIFS Share Readable By Everyone I think the following vulnerabilities are useless for me at the moment: Weak LAN Manager hashing permitted - without user interaction or services looking at the network, useless (I might be wrong here, will check this later) TCP Sequence Number Approximation Vulnerability - not interestingICMP netmask response - not interestingCIFS Share Readable By Everyone - unless there is a password in a text file, useless But we have two interesting vulns: CIFS NULL Session Permitted  - this could be interesting, I will check this later ...Windows 95/98/ME Share Level Password Bypass - BINGO! Let me quote Nexpose here: &quot;3.2.3 Windows 95/98/ME Share Level Password Bypass (CIFS-win9x-onebyte-password) A flaw in the Windows 95/98/ME File and Print Sharing service allows unauthorized users to access file and print shares by sending the first character of the password. Due to the limited number of attempts required to guess the password, brute force attacks can be performed in just a few seconds. Established connection to share TEST with password P.&quot; The vulnerability description at MS side: http://technet.microsoft.com/en-us/security/bulletin/ms00-072 For example if the password is &quot;Password&quot; (without quotes) and the client sends the password &quot;P&quot; (without quotes) and the length of 1, the client is authenticated. To find the rest of the password, the attacker increments the length to 2 and starts guessing the second letter until he reaches &quot;PA&quot; and gets authenticated again. As share passwords in Windows 95 are not case sensitive, &quot;Pa&quot; and &quot;PA&quot; will also be accepted. The attacker can continue to increment the length and guessing the next letter one-by-one until he gets the full &quot;PASSWORD&quot; (as the maximum length is 8 characters).I believe all characters between ALT+033 and ALT+255 can be used in the share password in Windows 95, but as it is case insensitive, we have 196 characters to use, and a maximum length of 8 characters. In worst case this means that we can guess the full password in 1568 requests. The funny thing is that the share password is not connected to (by default) any username/account, and it cannot be locked via brute force. Luckily there is a great tool which can exploit this vulnerability: Share Password Checker Let&#39;s check this tool in action: W00t w00t, it brute forced the password in less then 2 seconds! Looking at a wireshark dump we can see how it is done: As you can see, in the middle of the dump we can see that it already guessed the part &quot;PASS&quot; and it is brute-forcing the fifth character, it founds that &quot;W&quot; is the correct fifth character, and starts brute-forcing the sixth character. If we are lucky with the CTF, the whole C:\ drive is shared with full read-write access, and we can write our team identifier into the c:\flag.txt. But what if we want remote code execution? Stay tuned, this is going to be the topic of the next part of this post." />
<link rel="canonical" href="https://httpscolonforwardslashforwardslashwwwdotzoltanbalazsdotcom.com/hacking/ms00-072/pentest/win95/windows95/2014/02/02/Hacking-Windows-95,-part-1.html" />
<meta property="og:url" content="https://httpscolonforwardslashforwardslashwwwdotzoltanbalazsdotcom.com/hacking/ms00-072/pentest/win95/windows95/2014/02/02/Hacking-Windows-95,-part-1.html" />
<meta property="og:site_name" content="Jump ESP, jump!" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2014-02-02T15:56:35+00:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Hacking Windows 95, part 1" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2014-02-02T15:56:35+00:00","datePublished":"2014-02-02T15:56:35+00:00","description":"During a CTF game, we came across very-very old systems. Turns out, it is not that easy to hack those dinosaur old systems, because modern tools like Metasploit do not have sploits for those old boxes and of course our &quot;133t h4cking skillz&quot; are useless without Metasploit... :) But I had an idea: This can be a pretty good small research for fun. The rules for the hack are the following: Only publicly available tools can be used for this hack, so no tool development. This is a CTF for script bunniez, and we can&#39;t haz code!Only hacks without user interaction are allowed (IE based sploits are out of scope).I need instant remote code execution. For example, if I can drop a malware to the c: drive, and change autoexec.bat, I&#39;m still not done, because no one will reboot the CTF machine in a real CTF for me. If I can reboot the machine, that&#39;s OK.I don&#39;t have physical access. I have chosen Windows 95 for this task. First, I had to get a genuine Windows 95 installer, so I visited the Microsoft online shop and downloaded it from their official site. I installed it in a virtualized environment (remember, you need a boot floppy to install from the CD), and it hit me with a serious nostalgia bomb after watching the installer screens. &quot;Easier to use&quot;, &quot;faster and more efficient&quot;, &quot;high-powered performance&quot;, &quot;friendly&quot;, &quot;intuitive interface&quot;. Who does not want that? :) Now that I have a working Windows 95 box, setting up the TCP/IP is easy, let&#39;s try to hack it! My first tool is always nmap. Let&#39;s scan the box! Below I&#39;m showing the interesting parts from the result: PORT STATE SERVICE VERSION 139/tcp open netbios-ssn 137/udp open|filtered netbios-ns 138/udp open|filtered netbios-dgm Running: Microsoft Windows 3.X|95 OS details: Microsoft Windows for Workgroups 3.11 or Windows 95 TCP Sequence Prediction: Difficulty=25 (Good luck!) IP ID Sequence Generation: Broken little-endian incremental The first exciting thing to note is that there is no port 445! Port 445 is only since NT 4.0. If you check all the famous windows sploits (e.g., MS03-026, MS08-067), all of them use port 445 and named pipes. But there are no named pipes on Windows 95! Because I&#39;m a Nessus monkey, let&#39;s run a free Nessus scan on it! Only one critical vulnerability found: Microsoft Windows NT 4.0 Unsupported Installation Detection Thanks for nothing, Nessus! But at least it was for free. Next, I tried GFI Languard, nothing. It detected the machine as Win95, the opened TCP port, and some UDP ports as open (false-positive), and that&#39;s all... Let&#39;s try another free vulnerability scanner tool, Nexpose. The results are much better: CIFS NULL Session Permitted  Weak LAN Manager hashing permitted SMB signing not required Windows 95/98/ME Share Level Password Bypass   TCP Sequence Number Approximation Vulnerability  ICMP netmask response CIFS Share Readable By Everyone I think the following vulnerabilities are useless for me at the moment: Weak LAN Manager hashing permitted - without user interaction or services looking at the network, useless (I might be wrong here, will check this later) TCP Sequence Number Approximation Vulnerability - not interestingICMP netmask response - not interestingCIFS Share Readable By Everyone - unless there is a password in a text file, useless But we have two interesting vulns: CIFS NULL Session Permitted  - this could be interesting, I will check this later ...Windows 95/98/ME Share Level Password Bypass - BINGO! Let me quote Nexpose here: &quot;3.2.3 Windows 95/98/ME Share Level Password Bypass (CIFS-win9x-onebyte-password) A flaw in the Windows 95/98/ME File and Print Sharing service allows unauthorized users to access file and print shares by sending the first character of the password. Due to the limited number of attempts required to guess the password, brute force attacks can be performed in just a few seconds. Established connection to share TEST with password P.&quot; The vulnerability description at MS side: http://technet.microsoft.com/en-us/security/bulletin/ms00-072 For example if the password is &quot;Password&quot; (without quotes) and the client sends the password &quot;P&quot; (without quotes) and the length of 1, the client is authenticated. To find the rest of the password, the attacker increments the length to 2 and starts guessing the second letter until he reaches &quot;PA&quot; and gets authenticated again. As share passwords in Windows 95 are not case sensitive, &quot;Pa&quot; and &quot;PA&quot; will also be accepted. The attacker can continue to increment the length and guessing the next letter one-by-one until he gets the full &quot;PASSWORD&quot; (as the maximum length is 8 characters).I believe all characters between ALT+033 and ALT+255 can be used in the share password in Windows 95, but as it is case insensitive, we have 196 characters to use, and a maximum length of 8 characters. In worst case this means that we can guess the full password in 1568 requests. The funny thing is that the share password is not connected to (by default) any username/account, and it cannot be locked via brute force. Luckily there is a great tool which can exploit this vulnerability: Share Password Checker Let&#39;s check this tool in action: W00t w00t, it brute forced the password in less then 2 seconds! Looking at a wireshark dump we can see how it is done: As you can see, in the middle of the dump we can see that it already guessed the part &quot;PASS&quot; and it is brute-forcing the fifth character, it founds that &quot;W&quot; is the correct fifth character, and starts brute-forcing the sixth character. If we are lucky with the CTF, the whole C:\\ drive is shared with full read-write access, and we can write our team identifier into the c:\\flag.txt. But what if we want remote code execution? Stay tuned, this is going to be the topic of the next part of this post.","headline":"Hacking Windows 95, part 1","mainEntityOfPage":{"@type":"WebPage","@id":"https://httpscolonforwardslashforwardslashwwwdotzoltanbalazsdotcom.com/hacking/ms00-072/pentest/win95/windows95/2014/02/02/Hacking-Windows-95,-part-1.html"},"url":"https://httpscolonforwardslashforwardslashwwwdotzoltanbalazsdotcom.com/hacking/ms00-072/pentest/win95/windows95/2014/02/02/Hacking-Windows-95,-part-1.html"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/css/style.css">
  <link rel="icon" type="image/png" href="/assets/favicon.png" />
  <link rel="stylesheet" href="/assets/css/magnific-popup.css"><link type="application/atom+xml" rel="alternate" href="https://httpscolonforwardslashforwardslashwwwdotzoltanbalazsdotcom.com/feed.xml" title="Jump ESP, jump!" /><script src="https://code.jquery.com/jquery-3.2.0.min.js"></script> 
  <script src="/assets/js/jquery.magnific-popup.js"></script>
</head>
<body><div class="site-header">
  <div class="wrapper">
    <a class="site-title" rel="author" href="/">Jump ESP, jump!<b class="command_prompt"></b><b class="blinking_cursor">_</b></a>
    <span class="social_links">
        
    </span>
  </div>
</div>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        
  <div class="author-box">


<img src="
    https://gravatar.com/avatar/d41d8cd98f00b204e9800998ecf8427e?s=256
" class="author-avatar" alt="Avatar" />
<div class="description">Because Google started to delete hacking related blog posts  without using a single brain cell, I had to learn just another framework. Thx Google </div>

</div>


<div class="post">
  <h1 class="post-title">Hacking Windows 95, part 1</h1>
  
  <div class="post-tags">
      
  </div>
  
  <div class="post-date">
    Published on 02 Feb 2014
    
  </div>
  
  <div style="">During a CTF game, we came across very-very old systems. Turns out, it is not that easy to hack those dinosaur old systems, because modern tools like Metasploit do not have sploits for those old boxes and of course our "133t h4cking skillz" are useless without Metasploit... :)</div>
<p>But I had an idea: This can be a pretty good small research for fun.
The rules for the hack are the following:</p>
<ol><li>Only publicly available tools can be used for this hack, so no tool development. This is a CTF for script bunniez, and we can't haz code!</li><li>Only hacks without user interaction are allowed (IE based sploits are out of scope).</li><li>I need instant remote code execution. For example, if I can drop a malware to the c: drive, and change autoexec.bat, I'm still not done, because no one will reboot the CTF machine in a real CTF for me. If I can reboot the machine, that's OK.</li><li>I don't have physical access.</li></ol>
<div style="">I have chosen Windows 95 for this task. First, I had to get a genuine Windows 95 installer, so I visited the Microsoft online shop and downloaded it from their official site.</div>
<div style="">
</div>
<div style="">I installed it in a virtualized environment (remember, you need a boot floppy to install from the CD), and it hit me with a serious nostalgia bomb after watching the installer screens. "Easier to use", "faster and more efficient", "high-powered performance", "friendly", "intuitive interface". Who does not want that? :)</div>
<div><a href="https://z6543.github.io/_img/win95_01.png" src="https://z6543.github.io/_img/win95_01.png" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="" src="https://z6543.github.io/_img/win95_01.png" width="400" /></a></div>
<div><a href="https://z6543.github.io/_img/win95_02.png" src="https://z6543.github.io/_img/win95_02.png" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="" src="https://z6543.github.io/_img/win95_02.png" width="400" /></a></div>
<div><a href="https://z6543.github.io/_img/win95_03.png" src="https://z6543.github.io/_img/win95_03.png" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="" src="https://z6543.github.io/_img/win95_03.png" width="400" /></a></div>
<div></div>
<div><a href="https://z6543.github.io/_img/win95_04.png" src="https://z6543.github.io/_img/win95_04.png" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="" src="https://z6543.github.io/_img/win95_04.png" width="400" /></a></div>
<div><a href="https://z6543.github.io/_img/win95_05.png" src="https://z6543.github.io/_img/win95_05.png" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="" src="https://z6543.github.io/_img/win95_05.png" width="400" /></a></div>
<div style="">Now that I have a working Windows 95 box, setting up the TCP/IP is easy, let's try to hack it!</div>
<div style="">
</div>
<div style="">My first tool is always nmap. Let's scan the box! Below I'm showing the interesting parts from the result:</div>
<div style="">
</div>
<div style=""><pre class="prettyprint linenums lang-html">PORT      STATE           SERVICE       VERSION
139/tcp   open            netbios-ssn
137/udp   open|filtered   netbios-ns
138/udp   open|filtered   netbios-dgm
Running: Microsoft Windows 3.X|95
OS details: Microsoft Windows for Workgroups 3.11 or Windows 95
TCP Sequence Prediction: Difficulty=25 (Good luck!)
IP ID Sequence Generation: Broken little-endian incremental
</pre></div>
<div style=""><br /></div>
<div style="">The first exciting thing to note is that there is no port 445! Port 445 is only since NT 4.0. If you check all the famous windows sploits (e.g., MS03-026, MS08-067), all of them use port 445 and named pipes. But there are no named pipes on Windows 95!</div>
<div style=""><br /></div>
<div style="">Because I'm a Nessus monkey, let's run a free Nessus scan on it!<br /><br /></div>
<div style="">Only one critical vulnerability found:</div>
<div style="">Microsoft Windows NT 4.0 Unsupported Installation Detection</div>
<div style=""><br /></div>
<div style="">Thanks for nothing, Nessus! But at least it was for free.</div>
<div style=""><br /></div>
<div style="">Next, I tried GFI Languard, nothing. It detected the machine as Win95, the opened TCP port, and some UDP ports as open (false-positive), and that's all...</div>
<div style=""><br /></div>
<div style="">Let's try another free vulnerability scanner tool, Nexpose. The results are much better:</div>
<ul><li>CIFS NULL Session Permitted<span class="Apple-tab-span" style="white-space: pre;"> </span> </li><li>Weak LAN Manager hashing permitted<span class="Apple-tab-span" style="white-space: pre;"> </span></li><li>SMB signing not required<span class="Apple-tab-span" style="white-space: pre;"> </span></li><li>Windows 95/98/ME Share Level Password Bypass<span class="Apple-tab-span" style="white-space: pre;"> </span>  </li><li>TCP Sequence Number Approximation Vulnerability<span class="Apple-tab-span" style="white-space: pre;"> </span> </li><li>ICMP netmask response<span class="Apple-tab-span" style="white-space: pre;"> </span></li><li>CIFS Share Readable By Everyone</li></ul>
<div style="">I think the following vulnerabilities are useless for me at the moment:</div>
<ul><li>Weak LAN Manager hashing permitted - without user interaction or services looking at the network, useless (I might be wrong here, will check this later)<span class="Apple-tab-span" style="white-space: pre;"> </span></li><li>TCP Sequence Number Approximation Vulnerability - not interesting</li><li>ICMP netmask response<span style="white-space: pre;"> </span>- not interesting</li><li>CIFS Share Readable By Everyone - unless there is a password in a text file, useless</li></ul>
<div style="">But we have two interesting vulns:</div>
<ul><li>CIFS NULL Session Permitted<span class="Apple-tab-span" style="white-space: pre;"> </span> - this could be interesting, I will check this later ...</li><li>Windows 95/98/ME Share Level Password Bypass - BINGO!</li></ul>
<div><div style="">Let me quote Nexpose here:</div><div style=""><br /></div></div>
<div><div style="">"3.2.3 Windows 95/98/ME Share Level Password Bypass (CIFS-win9x-onebyte-password)</div></div>
<div><div style=""><br /></div></div>
<div><div style="">A flaw in the Windows 95/98/ME File and Print Sharing service allows unauthorized users to access file and print shares by sending the first character of the password. Due to the limited number of attempts required to guess the password, brute force attacks can be performed in just a few seconds.</div></div>
<div><div style=""><br /></div></div>
<div><div style="">Established connection to share TEST with password P."</div></div>
<div><div style=""><br /></div></div>
<div style="">The vulnerability description at MS side:</div>
<div style=""><a href="http://technet.microsoft.com/en-us/security/bulletin/ms00-072">http://technet.microsoft.com/en-us/security/bulletin/ms00-072</a></div>
<div style=""><br /></div>
<div style="">For example if the password is "Password" (without quotes) and the client sends the password "P" (without quotes) and the length of 1, the client is authenticated. To find the rest of the password, the attacker increments the length to 2 and starts guessing the second letter until he reaches "PA" and gets authenticated again. As share passwords in Windows 95 are not case sensitive, "Pa" and "PA" will also be accepted. The attacker can continue to increment the length and guessing the next letter one-by-one until he gets the full "PASSWORD" (as the maximum length is 8 characters).<br /><br />I believe all characters between ALT+033 and ALT+255 can be used in the share password in Windows 95, but as it is case insensitive, we have 196 characters to use, and a maximum length of 8 characters. In worst case this means that we can guess the full password in 1568 requests. The funny thing is that the share password is not connected to (by default) any username/account, and it cannot be locked via brute force.</div>
<div style="">Luckily there is a great tool which can exploit this vulnerability:</div>
<div style=""><a href="http://www.securityfriday.com/tools/SPC.html">Share Password Checker</a></div>
<div style="">
</div>
<div style="">Let's check this tool in action:</div>
<div style="">
</div>
<div><a href="https://z6543.github.io/_img/spc_hack.png" src="https://z6543.github.io/_img/spc_hack.png" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="" src="https://z6543.github.io/_img/spc_hack.png" width="320" /></a></div>
<div style="">W00t w00t, it brute forced the password in less then 2 seconds!</div>
<div style="">
</div>
<div style="">Looking at a wireshark dump we can see how it is done:</div>
<div></div>
<div>
<a href="https://z6543.github.io/_img/wireshark.png" src="https://z6543.github.io/_img/wireshark.png" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="" src="https://z6543.github.io/_img/wireshark.png" width="400" /></a></div>
<div style="">As you can see, in the middle of the dump we can see that it already guessed the part "PASS" and it is brute-forcing the fifth character, it founds that "W" is the correct fifth character, and starts brute-forcing the sixth character.</div>
<div style="">
</div>
<div style="">If we are lucky with the CTF, the whole C:\ drive is shared with full read-write access, and we can write our team identifier into the c:\flag.txt. But what if we want remote code execution? Stay tuned, this is going to be the topic of the <a href="http://jumpespjump.blogspot.hu/2014/05/hacking-windows-95-part-2.html">next part of this post</a>.</div>

</div>





<div class="related">
  <h2>related posts</h2>
  <ul class="related-posts">
    
      <li>
        <h3>
          <a href="/2024/03/01/VPN-Snakeoil.html">
            Personal VPN services are snake-oil
          </a>
        </h3>
      </li>
    
      <li>
        <h3>
          <a href="/2023/04/05/Just_use_Jekyll.html">
            "Just" migrate to Jekyll ...
          </a>
        </h3>
      </li>
    
      <li>
        <h3>
          <a href="/2022/09/16/Google.html">
            So Long Google, and Thanks for All the Fish
          </a>
        </h3>
      </li>
    
  </ul>
</div>




  




<script>
  let i = 0;
  const text = '';
  const speed = parseInt('50');
  
  function typeWriter() {
    if (i < text.length) {
      document.getElementById('animated-post-description').innerHTML += text.charAt(i);
      i++;
      setTimeout(typeWriter, speed);
    }
  }

  document.getElementById('animated-post-description').style.display = 'initial';
  typeWriter();

  // Image modal
  var $imgs = [];
  $('img').each(function(idx) {
    var obj = {
      src: $(this).attr('src')
    }
    $imgs.push(obj);
    var elem = $(this);
    $(this).click(function() {
      $('.modal').magnificPopup('open', idx);
    });
  });

  $('.modal').magnificPopup({
    items: $imgs,
    type: 'image',
    closeOnContentClick: true,
    mainClass: 'mfp-img-mobile',
    image: {
      verticalFit: true
    }
    
  });
</script>

      </div>
    </main><footer class="site-footer">
  <div class="wrapper">
    <div class="credits"><a href="https://github.com/bitbrain/jekyll-dash">dash</a> theme for Jekyll by <a href="https://github.com/bitbrain">bitbrain</a> made with <i class="fas fa-heart"></i><div class="toggleWrapper">
    <input type="checkbox" class="dn" id="theme-toggle" onclick="modeSwitcher()" checked />
    <label for="theme-toggle" class="toggle">
    <span class="toggle__handler">
      <span class="crater crater--1"></span>
      <span class="crater crater--2"></span>
      <span class="crater crater--3"></span>
    </span>
        <span class="star star--1"></span>
        <span class="star star--2"></span>
        <span class="star star--3"></span>
        <span class="star star--4"></span>
        <span class="star star--5"></span>
        <span class="star star--6"></span>
    </label>
</div>
<script type="text/javascript">
const theme = localStorage.getItem('theme');

if (theme === "light") {
    document.documentElement.setAttribute('data-theme', 'light');
} else {
    document.documentElement.setAttribute('data-theme', 'dark');
}
const userPrefers = getComputedStyle(document.documentElement).getPropertyValue('content');

function activateDarkTheme() {
    document.getElementById('theme-toggle').checked = true;
    document.documentElement.setAttribute('data-theme', 'dark');
    document.documentElement.classList.add('theme--dark');
    document.documentElement.classList.remove('theme--light');
	document.getElementById("theme-toggle").className = 'light';
	window.localStorage.setItem('theme', 'dark');
}

function activateLightTheme() {
    document.getElementById('theme-toggle').checked = false;
    document.documentElement.setAttribute('data-theme', 'light');
    document.documentElement.classList.add('theme--light');
    document.documentElement.classList.remove('theme--dark');
	document.getElementById("theme-toggle").className = 'dark';
	window.localStorage.setItem('theme', 'light');
}

if (theme === "dark") {
    activateDarkTheme();
} else if (theme === "light") {
    activateLightTheme();
} else if  (userPrefers === "light") {
    activateDarkTheme();
} else {
    activateDarkTheme();
}

function modeSwitcher() {
	let currentMode = document.documentElement.getAttribute('data-theme');
	if (currentMode === "dark") {
	    activateLightTheme();
	} else {
	    activateDarkTheme();
	}
}
</script></div>
  </div>
</footer>


<script>
      window.FontAwesomeConfig = {
        searchPseudoElements: true
      }
    </script>
  </body>

</html>
